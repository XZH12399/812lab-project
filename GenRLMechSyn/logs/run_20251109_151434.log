2025-11-09 15:14:34,464 - INFO - GenRLMechSyn 训练开始 - run_20251109_151434
2025-11-09 15:14:34,474 - INFO - --- 成功加载配置文件 ---
2025-11-09 15:14:34,474 - INFO - 路径: /home/XZH/projects/GenRLMechSyn/configs/default_config.yaml
2025-11-09 15:14:34,474 - INFO - 项目名称: GenRLMechSyn
2025-11-09 15:14:34,503 - INFO - --- 所有随机数种子已固定为: 42 ---
2025-11-09 15:14:34,503 - INFO - --- PyTorch CUDNN 已设置为确定性模式 (可能影响性能) ---
2025-11-09 15:14:34,503 - INFO - --- 正在初始化训练流程 ---
2025-11-09 15:14:34,503 - INFO - 训练将在 NVIDIA CUDA GPU 上运行。
2025-11-09 15:14:37,176 - INFO - --- 正在初始化所有模块... ---
2025-11-09 15:14:38,784 - INFO - DiffusionTransformer (DiT) 模型已初始化 (输入通道: 5):
2025-11-09 15:14:38,785 - INFO -   Embed Dim: 768, Depth: 12, Heads: 12
2025-11-09 15:14:38,785 - INFO -   Image: 6x6, Patch: 2, Patches: 9
2025-11-09 15:14:38,785 - INFO -   Normalization values (a, alpha, offset): [20.0, 1.5707999467849731, 20.0]
2025-11-09 15:14:39,476 - INFO - --- 强化学习 (RL) 智能体已初始化 (奖励预测模型) ---
2025-11-09 15:14:39,476 - INFO -   RL Model Depth: 4
2025-11-09 15:14:40,615 - INFO - --- 未指定或加载检查点失败, 所有模块使用随机初始化权重 ---
2025-11-09 15:14:40,616 - INFO - 正在加载 Replay Buffer (来自 augmented_dataset)...
2025-11-09 15:14:40,616 - INFO - 信息: augmented_manifest.json 不存在, Replay Buffer 为空。
2025-11-09 15:14:40,616 - INFO - --- 训练流程已准备就绪 ---
2025-11-09 15:14:40,616 - INFO -   RL 引导: True
2025-11-09 15:14:40,616 - INFO -   数据增强: False
2025-11-09 15:14:40,616 - INFO - --- 训练流程开始 ---
2025-11-09 15:14:40,616 - INFO - [检测到] DiT 使用随机初始化权重, 将进行预热训练...
2025-11-09 15:14:40,616 - INFO - --- DiT 预热阶段: 在初始数据集上训练 50 轮 ---
2025-11-09 15:14:40,617 - INFO - 初始数据集大小: 100 个机构
2025-11-09 15:14:54,362 - INFO -   预热 Epoch [010/050] | MSE Loss: 0.099985
2025-11-09 15:15:03,763 - INFO -   预热 Epoch [020/050] | MSE Loss: 0.103157
2025-11-09 15:15:12,954 - INFO -   预热 Epoch [030/050] | MSE Loss: 0.071726
2025-11-09 15:15:21,687 - INFO -   预热 Epoch [040/050] | MSE Loss: 0.093776
2025-11-09 15:15:30,882 - INFO -   预热 Epoch [050/050] | MSE Loss: 0.072576
2025-11-09 15:15:30,882 - INFO - --- DiT 预热完成! 模型已学习初始数据集的基本结构 ---
2025-11-09 15:15:30,883 - INFO - [检测到] RL 引导已启用, 但 Replay Buffer 为空. 将进行 RL 预热...
2025-11-09 15:15:30,883 - INFO - --- RL 智能体预热阶段: 在初始数据集上训练 50 轮 ---
2025-11-09 15:15:30,884 - INFO - 正在从 100 个初始样本中预填充 Replay Buffer...
2025-11-09 15:15:31,291 - INFO - Replay Buffer 预填充完成. 当前总经验: 100
2025-11-09 15:15:31,291 - INFO - 开始在 100 个样本上预训练 RL Agent...
2025-11-09 15:15:36,857 - INFO -   RL 预热 Epoch [010/050] | Avg MSE Loss: 0.000032
2025-11-09 15:15:42,458 - INFO -   RL 预热 Epoch [020/050] | Avg MSE Loss: 0.000022
2025-11-09 15:15:48,089 - INFO -   RL 预热 Epoch [030/050] | Avg MSE Loss: 0.000018
2025-11-09 15:15:53,775 - INFO -   RL 预热 Epoch [040/050] | Avg MSE Loss: 0.000014
2025-11-09 15:15:59,411 - INFO -   RL 预热 Epoch [050/050] | Avg MSE Loss: 0.000012
2025-11-09 15:15:59,412 - INFO - --- RL 智能体预热完成! 平均 Loss: 0.000052 ---
2025-11-09 15:15:59,412 - INFO - --- 开始总共 300 轮的训练循环 ---
2025-11-09 15:15:59,412 - INFO - ===== [ 完整循环 1/300 ] =====
2025-11-09 15:15:59,412 - INFO - 

2025-11-09 15:15:59,412 - INFO - --- 步骤 1 & 2: 生成, 评估, 扩充 ---
2025-11-09 15:15:59,413 - INFO - RL 引导已启用。
2025-11-09 15:15:59,413 - INFO - 正在生成 50 个目标标签为 'bennett' 的机构...
2025-11-09 15:15:59,413 - INFO - 开始采样 50 个新机构 (格式: [exists, joint_type, a, alpha, offset])...
2025-11-09 15:16:30,908 - INFO - 采样完成. 共生成 50 个机构张量 (已应用最终钳位)。
2025-11-09 15:16:30,908 - INFO - 评估 50 个新生成的机构...
2025-11-09 15:16:31,027 - INFO - 生成机构平均得分: 0.0155 (Min: 0.0000, Max: 0.4250)
2025-11-09 15:16:31,027 - INFO - 评估完成. 0 / 50 个机构满足分数要求...
2025-11-09 15:16:31,027 - INFO - 数据增强已关闭。跳过保存。
2025-11-09 15:16:31,028 - INFO -   生成与评估耗时: 31.62 秒
2025-11-09 15:16:31,028 - INFO - 

2025-11-09 15:16:31,028 - INFO - --- 步骤 3a: 训练 RL 智能体 ---
2025-11-09 15:16:31,028 - INFO - Replay Buffer 中共有 150 个经验。
2025-11-09 15:16:31,819 - INFO - --- RL Agent 训练完成. 平均 Loss: 0.002078 ---
2025-11-09 15:16:31,819 - INFO -   RL 训练耗时: 0.79 秒
2025-11-09 15:16:31,819 - INFO - 

2025-11-09 15:16:31,819 - INFO - 数据增强已关闭。DiT 将仅在 [初始] 数据集上训练。
2025-11-09 15:16:31,820 - INFO - --- 步骤 3b: 训练 DiT (模仿者) ---
2025-11-09 15:16:31,820 - INFO - 将使用 100 个机构进行训练。
2025-11-09 15:16:41,254 - INFO -   DiT Epoch [010/050] | MSE Loss: 0.059045
2025-11-09 15:16:50,630 - INFO -   DiT Epoch [020/050] | MSE Loss: 0.044067
2025-11-09 15:16:59,761 - INFO -   DiT Epoch [030/050] | MSE Loss: 0.049333
2025-11-09 15:17:08,714 - INFO -   DiT Epoch [040/050] | MSE Loss: 0.051278
2025-11-09 15:17:17,730 - INFO -   DiT Epoch [050/050] | MSE Loss: 0.035760
2025-11-09 15:17:17,731 - INFO -   DiT 训练耗时: 45.91 秒
2025-11-09 15:17:17,731 - INFO - 

2025-11-09 15:17:17,731 - INFO - --- 正在保存【完整】训练检查点 (用于 cycle 0) ---
2025-11-09 15:17:17,731 - INFO - 路径: /home/XZH/projects/GenRLMechSyn/checkpoints/training_checkpoint.pth
2025-11-09 15:17:21,542 - INFO - --- 完整检查点保存成功 ---
2025-11-09 15:17:21,542 - INFO - 

2025-11-09 15:17:21,542 - INFO - ===== [ 完整循环 2/300 ] =====
2025-11-09 15:17:21,542 - INFO - 

2025-11-09 15:17:21,542 - INFO - --- 步骤 1 & 2: 生成, 评估, 扩充 ---
2025-11-09 15:17:21,543 - INFO - RL 引导已启用。
2025-11-09 15:17:21,543 - INFO - 正在生成 50 个目标标签为 'bennett' 的机构...
2025-11-09 15:17:21,543 - INFO - 开始采样 50 个新机构 (格式: [exists, joint_type, a, alpha, offset])...
2025-11-09 15:17:51,990 - INFO - 采样完成. 共生成 50 个机构张量 (已应用最终钳位)。
2025-11-09 15:17:51,990 - INFO - 评估 50 个新生成的机构...
2025-11-09 15:17:52,018 - INFO - 生成机构平均得分: 0.0640 (Min: 0.0000, Max: 0.8000)
2025-11-09 15:17:52,019 - INFO - 评估完成. 0 / 50 个机构满足分数要求...
2025-11-09 15:17:52,019 - INFO - 数据增强已关闭。跳过保存。
2025-11-09 15:17:52,019 - INFO -   生成与评估耗时: 30.48 秒
2025-11-09 15:17:52,019 - INFO - 

2025-11-09 15:17:52,019 - INFO - --- 步骤 3a: 训练 RL 智能体 ---
2025-11-09 15:17:52,019 - INFO - Replay Buffer 中共有 200 个经验。
2025-11-09 15:17:52,977 - INFO - --- RL Agent 训练完成. 平均 Loss: 0.009310 ---
2025-11-09 15:17:52,977 - INFO -   RL 训练耗时: 0.96 秒
2025-11-09 15:17:52,977 - INFO - 

2025-11-09 15:17:52,977 - INFO - 数据增强已关闭。DiT 将仅在 [初始] 数据集上训练。
2025-11-09 15:17:53,035 - INFO - --- 步骤 3b: 训练 DiT (模仿者) ---
2025-11-09 15:17:53,035 - INFO - 将使用 100 个机构进行训练。
2025-11-09 15:18:01,149 - INFO -   DiT Epoch [010/050] | MSE Loss: 0.045152
2025-11-09 15:18:09,099 - INFO -   DiT Epoch [020/050] | MSE Loss: 0.035257
2025-11-09 15:18:18,710 - INFO -   DiT Epoch [030/050] | MSE Loss: 0.037566
2025-11-09 15:18:27,940 - INFO -   DiT Epoch [040/050] | MSE Loss: 0.026542
2025-11-09 15:18:37,492 - INFO -   DiT Epoch [050/050] | MSE Loss: 0.035095
2025-11-09 15:18:37,493 - INFO -   DiT 训练耗时: 44.52 秒
2025-11-09 15:18:37,493 - INFO - 

2025-11-09 15:18:37,493 - INFO - --- 正在保存【完整】训练检查点 (用于 cycle 1) ---
2025-11-09 15:18:37,493 - INFO - 路径: /home/XZH/projects/GenRLMechSyn/checkpoints/training_checkpoint.pth
2025-11-09 15:18:41,775 - INFO - --- 完整检查点保存成功 ---
2025-11-09 15:18:41,775 - INFO - 

2025-11-09 15:18:41,775 - INFO - ===== [ 完整循环 3/300 ] =====
2025-11-09 15:18:41,775 - INFO - 

2025-11-09 15:18:41,775 - INFO - --- 步骤 1 & 2: 生成, 评估, 扩充 ---
2025-11-09 15:18:41,776 - INFO - RL 引导已启用。
2025-11-09 15:18:41,776 - INFO - 正在生成 50 个目标标签为 'bennett' 的机构...
2025-11-09 15:18:41,776 - INFO - 开始采样 50 个新机构 (格式: [exists, joint_type, a, alpha, offset])...
2025-11-09 15:19:12,746 - INFO - 采样完成. 共生成 50 个机构张量 (已应用最终钳位)。
2025-11-09 15:19:12,746 - INFO - 评估 50 个新生成的机构...
2025-11-09 15:19:12,865 - INFO - 生成机构平均得分: 0.1298 (Min: 0.0000, Max: 0.4250)
2025-11-09 15:19:12,865 - INFO - 评估完成. 0 / 50 个机构满足分数要求...
2025-11-09 15:19:12,865 - INFO - 数据增强已关闭。跳过保存。
2025-11-09 15:19:12,865 - INFO -   生成与评估耗时: 31.09 秒
2025-11-09 15:19:12,865 - INFO - 

2025-11-09 15:19:12,865 - INFO - --- 步骤 3a: 训练 RL 智能体 ---
2025-11-09 15:19:12,865 - INFO - Replay Buffer 中共有 250 个经验。
2025-11-09 15:19:14,265 - INFO - --- RL Agent 训练完成. 平均 Loss: 0.014285 ---
2025-11-09 15:19:14,265 - INFO -   RL 训练耗时: 1.40 秒
2025-11-09 15:19:14,266 - INFO - 

2025-11-09 15:19:14,266 - INFO - 数据增强已关闭。DiT 将仅在 [初始] 数据集上训练。
2025-11-09 15:19:14,266 - INFO - --- 步骤 3b: 训练 DiT (模仿者) ---
2025-11-09 15:19:14,266 - INFO - 将使用 100 个机构进行训练。
2025-11-09 15:19:23,677 - INFO -   DiT Epoch [010/050] | MSE Loss: 0.038132
2025-11-09 15:19:33,034 - INFO -   DiT Epoch [020/050] | MSE Loss: 0.036045
2025-11-09 15:19:42,431 - INFO -   DiT Epoch [030/050] | MSE Loss: 0.033921
2025-11-09 15:19:51,587 - INFO -   DiT Epoch [040/050] | MSE Loss: 0.026885
2025-11-09 15:20:00,383 - INFO -   DiT Epoch [050/050] | MSE Loss: 0.040662
2025-11-09 15:20:00,384 - INFO -   DiT 训练耗时: 46.12 秒
2025-11-09 15:20:00,384 - INFO - 

2025-11-09 15:20:00,384 - INFO - --- 正在保存【完整】训练检查点 (用于 cycle 2) ---
2025-11-09 15:20:00,384 - INFO - 路径: /home/XZH/projects/GenRLMechSyn/checkpoints/training_checkpoint.pth
2025-11-09 15:20:04,051 - INFO - --- 完整检查点保存成功 ---
2025-11-09 15:20:04,052 - INFO - 

2025-11-09 15:20:04,052 - INFO - ===== [ 完整循环 4/300 ] =====
2025-11-09 15:20:04,052 - INFO - 

2025-11-09 15:20:04,052 - INFO - --- 步骤 1 & 2: 生成, 评估, 扩充 ---
2025-11-09 15:20:04,053 - INFO - RL 引导已启用。
2025-11-09 15:20:04,053 - INFO - 正在生成 50 个目标标签为 'bennett' 的机构...
2025-11-09 15:20:04,053 - INFO - 开始采样 50 个新机构 (格式: [exists, joint_type, a, alpha, offset])...
2025-11-09 15:20:34,791 - INFO - 采样完成. 共生成 50 个机构张量 (已应用最终钳位)。
2025-11-09 15:20:34,792 - INFO - 评估 50 个新生成的机构...
2025-11-09 15:20:34,822 - INFO - 生成机构平均得分: 0.3442 (Min: 0.0000, Max: 0.8000)
2025-11-09 15:20:34,822 - INFO - 评估完成. 0 / 50 个机构满足分数要求...
2025-11-09 15:20:34,822 - INFO - 数据增强已关闭。跳过保存。
2025-11-09 15:20:34,822 - INFO -   生成与评估耗时: 30.77 秒
2025-11-09 15:20:34,822 - INFO - 

2025-11-09 15:20:34,822 - INFO - --- 步骤 3a: 训练 RL 智能体 ---
2025-11-09 15:20:34,822 - INFO - Replay Buffer 中共有 300 个经验。
2025-11-09 15:20:36,243 - INFO - --- RL Agent 训练完成. 平均 Loss: 0.033041 ---
2025-11-09 15:20:36,244 - INFO -   RL 训练耗时: 1.42 秒
2025-11-09 15:20:36,244 - INFO - 

2025-11-09 15:20:36,244 - INFO - 数据增强已关闭。DiT 将仅在 [初始] 数据集上训练。
2025-11-09 15:20:36,244 - INFO - --- 步骤 3b: 训练 DiT (模仿者) ---
2025-11-09 15:20:36,244 - INFO - 将使用 100 个机构进行训练。
2025-11-09 15:20:45,721 - INFO -   DiT Epoch [010/050] | MSE Loss: 0.031464
2025-11-09 15:20:55,134 - INFO -   DiT Epoch [020/050] | MSE Loss: 0.026506
2025-11-09 15:21:04,534 - INFO -   DiT Epoch [030/050] | MSE Loss: 0.021238
2025-11-09 15:21:13,841 - INFO -   DiT Epoch [040/050] | MSE Loss: 0.030845
2025-11-09 15:21:23,217 - INFO -   DiT Epoch [050/050] | MSE Loss: 0.033266
2025-11-09 15:21:23,217 - INFO -   DiT 训练耗时: 46.97 秒
2025-11-09 15:21:23,217 - INFO - 

2025-11-09 15:21:23,218 - INFO - --- 正在保存【完整】训练检查点 (用于 cycle 3) ---
2025-11-09 15:21:23,218 - INFO - 路径: /home/XZH/projects/GenRLMechSyn/checkpoints/training_checkpoint.pth
2025-11-09 15:21:26,443 - INFO - --- 完整检查点保存成功 ---
2025-11-09 15:21:26,443 - INFO - 

2025-11-09 15:21:26,443 - INFO - ===== [ 完整循环 5/300 ] =====
2025-11-09 15:21:26,443 - INFO - 

2025-11-09 15:21:26,444 - INFO - --- 步骤 1 & 2: 生成, 评估, 扩充 ---
2025-11-09 15:21:26,444 - INFO - RL 引导已启用。
2025-11-09 15:21:26,445 - INFO - 正在生成 50 个目标标签为 'bennett' 的机构...
2025-11-09 15:21:26,445 - INFO - 开始采样 50 个新机构 (格式: [exists, joint_type, a, alpha, offset])...
2025-11-09 15:21:57,143 - INFO - 采样完成. 共生成 50 个机构张量 (已应用最终钳位)。
2025-11-09 15:21:57,143 - INFO - 评估 50 个新生成的机构...
2025-11-09 15:21:57,193 - INFO - 生成机构平均得分: 0.0000 (Min: 0.0000, Max: 0.0000)
2025-11-09 15:21:57,193 - INFO - 评估完成. 0 / 50 个机构满足分数要求...
2025-11-09 15:21:57,193 - INFO - 数据增强已关闭。跳过保存。
2025-11-09 15:21:57,193 - INFO -   生成与评估耗时: 30.75 秒
2025-11-09 15:21:57,193 - INFO - 

2025-11-09 15:21:57,193 - INFO - --- 步骤 3a: 训练 RL 智能体 ---
2025-11-09 15:21:57,193 - INFO - Replay Buffer 中共有 350 个经验。
2025-11-09 15:21:58,746 - INFO - --- RL Agent 训练完成. 平均 Loss: 0.027320 ---
2025-11-09 15:21:58,747 - INFO -   RL 训练耗时: 1.55 秒
2025-11-09 15:21:58,747 - INFO - 

2025-11-09 15:21:58,747 - INFO - 数据增强已关闭。DiT 将仅在 [初始] 数据集上训练。
2025-11-09 15:21:58,747 - INFO - --- 步骤 3b: 训练 DiT (模仿者) ---
2025-11-09 15:21:58,747 - INFO - 将使用 100 个机构进行训练。
2025-11-09 15:22:08,211 - INFO -   DiT Epoch [010/050] | MSE Loss: 0.026257
2025-11-09 15:22:17,401 - INFO -   DiT Epoch [020/050] | MSE Loss: 0.036170
2025-11-09 15:22:26,679 - INFO -   DiT Epoch [030/050] | MSE Loss: 0.033050
2025-11-09 15:22:36,134 - INFO -   DiT Epoch [040/050] | MSE Loss: 0.023274
2025-11-09 15:22:45,469 - INFO -   DiT Epoch [050/050] | MSE Loss: 0.025927
2025-11-09 15:22:45,470 - INFO -   DiT 训练耗时: 46.72 秒
2025-11-09 15:22:45,470 - INFO - 

2025-11-09 15:22:45,470 - INFO - --- 正在保存【完整】训练检查点 (用于 cycle 4) ---
2025-11-09 15:22:45,470 - INFO - 路径: /home/XZH/projects/GenRLMechSyn/checkpoints/training_checkpoint.pth
2025-11-09 15:22:49,861 - INFO - --- 完整检查点保存成功 ---
2025-11-09 15:22:49,862 - INFO - 

2025-11-09 15:22:49,862 - INFO - ===== [ 完整循环 6/300 ] =====
2025-11-09 15:22:49,862 - INFO - 

2025-11-09 15:22:49,862 - INFO - --- 步骤 1 & 2: 生成, 评估, 扩充 ---
2025-11-09 15:22:49,863 - INFO - RL 引导已启用。
2025-11-09 15:22:49,863 - INFO - 正在生成 50 个目标标签为 'bennett' 的机构...
2025-11-09 15:22:49,863 - INFO - 开始采样 50 个新机构 (格式: [exists, joint_type, a, alpha, offset])...
2025-11-09 15:23:20,899 - INFO - 采样完成. 共生成 50 个机构张量 (已应用最终钳位)。
2025-11-09 15:23:20,900 - INFO - 评估 50 个新生成的机构...
2025-11-09 15:23:20,984 - INFO - 生成机构平均得分: 0.1305 (Min: 0.0000, Max: 0.8000)
2025-11-09 15:23:20,984 - INFO - 评估完成. 0 / 50 个机构满足分数要求...
2025-11-09 15:23:20,984 - INFO - 数据增强已关闭。跳过保存。
2025-11-09 15:23:20,984 - INFO -   生成与评估耗时: 31.12 秒
2025-11-09 15:23:20,984 - INFO - 

2025-11-09 15:23:20,984 - INFO - --- 步骤 3a: 训练 RL 智能体 ---
2025-11-09 15:23:20,984 - INFO - Replay Buffer 中共有 400 个经验。
2025-11-09 15:23:22,779 - INFO - --- RL Agent 训练完成. 平均 Loss: 0.029212 ---
2025-11-09 15:23:22,779 - INFO -   RL 训练耗时: 1.79 秒
2025-11-09 15:23:22,779 - INFO - 

2025-11-09 15:23:22,779 - INFO - 数据增强已关闭。DiT 将仅在 [初始] 数据集上训练。
2025-11-09 15:23:22,780 - INFO - --- 步骤 3b: 训练 DiT (模仿者) ---
2025-11-09 15:23:22,780 - INFO - 将使用 100 个机构进行训练。
2025-11-09 15:23:32,142 - INFO -   DiT Epoch [010/050] | MSE Loss: 0.026624
2025-11-09 15:23:41,376 - INFO -   DiT Epoch [020/050] | MSE Loss: 0.033910
2025-11-09 15:23:51,049 - INFO -   DiT Epoch [030/050] | MSE Loss: 0.023613
2025-11-09 15:24:00,444 - INFO -   DiT Epoch [040/050] | MSE Loss: 0.023791
2025-11-09 15:24:09,536 - INFO -   DiT Epoch [050/050] | MSE Loss: 0.027999
2025-11-09 15:24:09,536 - INFO -   DiT 训练耗时: 46.76 秒
2025-11-09 15:24:09,536 - INFO - 

2025-11-09 15:24:09,537 - INFO - --- 正在保存【完整】训练检查点 (用于 cycle 5) ---
2025-11-09 15:24:09,537 - INFO - 路径: /home/XZH/projects/GenRLMechSyn/checkpoints/training_checkpoint.pth
2025-11-09 15:24:12,778 - INFO - --- 完整检查点保存成功 ---
2025-11-09 15:24:12,778 - INFO - 

2025-11-09 15:24:12,779 - INFO - ===== [ 完整循环 7/300 ] =====
2025-11-09 15:24:12,779 - INFO - 

2025-11-09 15:24:12,779 - INFO - --- 步骤 1 & 2: 生成, 评估, 扩充 ---
2025-11-09 15:24:12,780 - INFO - RL 引导已启用。
2025-11-09 15:24:12,780 - INFO - 正在生成 50 个目标标签为 'bennett' 的机构...
2025-11-09 15:24:12,780 - INFO - 开始采样 50 个新机构 (格式: [exists, joint_type, a, alpha, offset])...
2025-11-09 15:24:43,553 - INFO - 采样完成. 共生成 50 个机构张量 (已应用最终钳位)。
2025-11-09 15:24:43,554 - INFO - 评估 50 个新生成的机构...
2025-11-09 15:24:43,796 - INFO - 生成机构平均得分: 0.3735 (Min: 0.0000, Max: 0.8000)
2025-11-09 15:24:43,796 - INFO - 评估完成. 0 / 50 个机构满足分数要求...
2025-11-09 15:24:43,796 - INFO - 数据增强已关闭。跳过保存。
2025-11-09 15:24:43,796 - INFO -   生成与评估耗时: 31.02 秒
2025-11-09 15:24:43,796 - INFO - 

2025-11-09 15:24:43,796 - INFO - --- 步骤 3a: 训练 RL 智能体 ---
2025-11-09 15:24:43,796 - INFO - Replay Buffer 中共有 450 个经验。
2025-11-09 15:24:46,177 - INFO - --- RL Agent 训练完成. 平均 Loss: 0.039391 ---
2025-11-09 15:24:46,178 - INFO -   RL 训练耗时: 2.38 秒
2025-11-09 15:24:46,178 - INFO - 

2025-11-09 15:24:46,178 - INFO - 数据增强已关闭。DiT 将仅在 [初始] 数据集上训练。
2025-11-09 15:24:46,178 - INFO - --- 步骤 3b: 训练 DiT (模仿者) ---
2025-11-09 15:24:46,178 - INFO - 将使用 100 个机构进行训练。
2025-11-09 15:24:55,564 - INFO -   DiT Epoch [010/050] | MSE Loss: 0.024417
2025-11-09 15:25:05,078 - INFO -   DiT Epoch [020/050] | MSE Loss: 0.032088
2025-11-09 15:25:14,101 - INFO -   DiT Epoch [030/050] | MSE Loss: 0.024202
2025-11-09 15:25:23,533 - INFO -   DiT Epoch [040/050] | MSE Loss: 0.019789
2025-11-09 15:25:33,140 - INFO -   DiT Epoch [050/050] | MSE Loss: 0.024447
2025-11-09 15:25:33,141 - INFO -   DiT 训练耗时: 46.96 秒
2025-11-09 15:25:33,141 - INFO - 

2025-11-09 15:25:33,142 - INFO - --- 正在保存【完整】训练检查点 (用于 cycle 6) ---
2025-11-09 15:25:33,142 - INFO - 路径: /home/XZH/projects/GenRLMechSyn/checkpoints/training_checkpoint.pth
2025-11-09 15:25:37,404 - INFO - --- 完整检查点保存成功 ---
2025-11-09 15:25:37,404 - INFO - 

2025-11-09 15:25:37,405 - INFO - ===== [ 完整循环 8/300 ] =====
2025-11-09 15:25:37,406 - INFO - 

2025-11-09 15:25:37,406 - INFO - --- 步骤 1 & 2: 生成, 评估, 扩充 ---
2025-11-09 15:25:37,407 - INFO - RL 引导已启用。
2025-11-09 15:25:37,407 - INFO - 正在生成 50 个目标标签为 'bennett' 的机构...
2025-11-09 15:25:37,407 - INFO - 开始采样 50 个新机构 (格式: [exists, joint_type, a, alpha, offset])...
2025-11-09 15:26:08,039 - INFO - 采样完成. 共生成 50 个机构张量 (已应用最终钳位)。
2025-11-09 15:26:08,040 - INFO - 评估 50 个新生成的机构...
2025-11-09 15:26:08,159 - INFO - 生成机构平均得分: 0.3493 (Min: 0.0000, Max: 0.7000)
2025-11-09 15:26:08,159 - INFO - 评估完成. 0 / 50 个机构满足分数要求...
2025-11-09 15:26:08,159 - INFO - 数据增强已关闭。跳过保存。
2025-11-09 15:26:08,159 - INFO -   生成与评估耗时: 30.75 秒
2025-11-09 15:26:08,159 - INFO - 

2025-11-09 15:26:08,159 - INFO - --- 步骤 3a: 训练 RL 智能体 ---
2025-11-09 15:26:08,159 - INFO - Replay Buffer 中共有 500 个经验。
2025-11-09 15:26:10,658 - INFO - --- RL Agent 训练完成. 平均 Loss: 0.041518 ---
2025-11-09 15:26:10,658 - INFO -   RL 训练耗时: 2.50 秒
2025-11-09 15:26:10,658 - INFO - 

2025-11-09 15:26:10,658 - INFO - 数据增强已关闭。DiT 将仅在 [初始] 数据集上训练。
2025-11-09 15:26:10,659 - INFO - --- 步骤 3b: 训练 DiT (模仿者) ---
2025-11-09 15:26:10,659 - INFO - 将使用 100 个机构进行训练。
2025-11-09 15:26:20,097 - INFO -   DiT Epoch [010/050] | MSE Loss: 0.032379
2025-11-09 15:26:29,523 - INFO -   DiT Epoch [020/050] | MSE Loss: 0.038468
2025-11-09 15:26:38,999 - INFO -   DiT Epoch [030/050] | MSE Loss: 0.032931
2025-11-09 15:26:48,433 - INFO -   DiT Epoch [040/050] | MSE Loss: 0.028123
2025-11-09 15:26:57,525 - INFO -   DiT Epoch [050/050] | MSE Loss: 0.017239
2025-11-09 15:26:57,526 - INFO -   DiT 训练耗时: 46.87 秒
2025-11-09 15:26:57,526 - INFO - 

2025-11-09 15:26:57,526 - INFO - --- 正在保存【完整】训练检查点 (用于 cycle 7) ---
2025-11-09 15:26:57,526 - INFO - 路径: /home/XZH/projects/GenRLMechSyn/checkpoints/training_checkpoint.pth
2025-11-09 15:27:01,209 - INFO - --- 完整检查点保存成功 ---
2025-11-09 15:27:01,210 - INFO - 

2025-11-09 15:27:01,210 - INFO - ===== [ 完整循环 9/300 ] =====
2025-11-09 15:27:01,210 - INFO - 

2025-11-09 15:27:01,210 - INFO - --- 步骤 1 & 2: 生成, 评估, 扩充 ---
2025-11-09 15:27:01,211 - INFO - RL 引导已启用。
2025-11-09 15:27:01,211 - INFO - 正在生成 50 个目标标签为 'bennett' 的机构...
2025-11-09 15:27:01,211 - INFO - 开始采样 50 个新机构 (格式: [exists, joint_type, a, alpha, offset])...
2025-11-09 15:27:32,163 - INFO - 采样完成. 共生成 50 个机构张量 (已应用最终钳位)。
2025-11-09 15:27:32,163 - INFO - 评估 50 个新生成的机构...
2025-11-09 15:27:32,281 - INFO - 生成机构平均得分: 0.2740 (Min: 0.0000, Max: 0.8000)
2025-11-09 15:27:32,281 - INFO - 评估完成. 0 / 50 个机构满足分数要求...
2025-11-09 15:27:32,281 - INFO - 数据增强已关闭。跳过保存。
2025-11-09 15:27:32,281 - INFO -   生成与评估耗时: 31.07 秒
2025-11-09 15:27:32,281 - INFO - 

2025-11-09 15:27:32,281 - INFO - --- 步骤 3a: 训练 RL 智能体 ---
2025-11-09 15:27:32,281 - INFO - Replay Buffer 中共有 550 个经验。
2025-11-09 15:27:35,270 - INFO - --- RL Agent 训练完成. 平均 Loss: 0.041793 ---
2025-11-09 15:27:35,271 - INFO -   RL 训练耗时: 2.99 秒
2025-11-09 15:27:35,271 - INFO - 

2025-11-09 15:27:35,271 - INFO - 数据增强已关闭。DiT 将仅在 [初始] 数据集上训练。
2025-11-09 15:27:35,272 - INFO - --- 步骤 3b: 训练 DiT (模仿者) ---
2025-11-09 15:27:35,272 - INFO - 将使用 100 个机构进行训练。
2025-11-09 15:27:44,809 - INFO -   DiT Epoch [010/050] | MSE Loss: 0.017146
2025-11-09 15:27:54,285 - INFO -   DiT Epoch [020/050] | MSE Loss: 0.017550
2025-11-09 15:28:03,507 - INFO -   DiT Epoch [030/050] | MSE Loss: 0.021785
2025-11-09 15:28:12,890 - INFO -   DiT Epoch [040/050] | MSE Loss: 0.016780
2025-11-09 15:28:13,014 - WARNING - 

--- 训练被用户手动中断 ---
2025-11-09 15:28:13,014 - WARNING - 程序已停止。
